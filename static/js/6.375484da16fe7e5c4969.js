webpackJsonp([6],{"45tM":function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s={name:"role",data:function(){return{centerDialogVisible:!1,innerVisible:!1,input:"",checkList:[],tableData:[],rolename:"",groupname:[],options:[],datas:[],information:[],menuIds:[],currentPage:1,pagesize:100,total:0,grouparr:[],menus:[],ischeck:!1,id:""}},components:{tree:i("pl2G").a},methods:{btndetele:function(e,t,i){this.del(this.HOST+"/v1/sys/role/delete",{roleId:t.id},e,i)},btnconfirm:function(){var e=this;if(!this.rolename||!this.groupname||!this.menuIds)return this.$message({message:e.$t("message.devicetype-13"),type:"warning"}),!1;e.ischeck?e.ajax(e.HOST+"/v1/sys/role/addOrUpdate",{menuIds:e.menuIds,name:e.rolename,userId:$.cookie("userId"),roleId:e.id},function(t){0==t.data.errCode?(e.$message({message:e.$t("message.devicemanage-6"),type:"success"}),e.getrolelist()):e.$message({message:e.$t("message.devicemanage-7")+t.data.msg,type:"error"}),e.centerDialogVisible=!1},function(e){}):e.ajax(e.HOST+"/v1/sys/role/addOrUpdate",{menuIds:e.menuIds,name:e.rolename,userId:$.cookie("userId")},function(t){0==t.data.errCode&&(e.$message({message:e.$t("message.devicetype-12"),type:"success"}),e.getrolelist()),e.centerDialogVisible=!1},function(e){})},checkchange:function(){console.log(this.checkList)},addrole:function(){this.centerDialogVisible=!0,this.information.url="/v1/sys/menu/findByParentId",this.information.data={id:"#"},this.ischeck=!1},dataRecieve:function(e){this.menuIds=e},btndedit:function(e,t){this.centerDialogVisible=!0,this.inputname=t.name,this.inputpass=t.password,this.inputphone=t.phone,this.inputemail=t.email,this.inputaddress=t.address,this.rolevalue=""},btnconfirmin:function(){var e=this.$refs.tree.$refs.tree.getCheckedKeys(),t=this.$refs.tree.$refs.tree.getHalfCheckedKeys();this.menuIds=e.concat(t),this.innerVisible=!1},getrolelist:function(){var e=this;e.ajax(e.HOST+"/v1/sys/role/findAll",{userId:$.cookie("userId"),currentPage:e.currentPage,rows:e.pagesize},function(t){0==t.data.errCode&&(e.total=t.data.totalPage,e.tableData=t.data.data)},function(e){})},getroledetails:function(e){var t=this,i=[],s=[];t.ajax(t.HOST+"/v1/sys/role/details",{roleId:e},function(e){if(0==e.data.errCode){e.data.data.menus.forEach(function(t){if(i.push(t.id),"#"==t.parentId)for(var n in e.data.data.menus)if(t.id==e.data.data.menus[n].parentId){s.push(t.id);break}});for(var n=0;n<s.length;n++)for(var a=0;a<i.length;a++)i[a]==s[n]&&(i.splice(a,1),a-=1);t.menus=i}},function(e){})},handleCurrentChange:function(e){this.currentPage=e,this.getrolelist()},btndcheck:function(e,t,i){this.rolename=t.name,this.centerDialogVisible=!0,this.information.url="/v1/sys/menu/findByParentId",this.information.data={id:"#"},this.getroledetails(t.id),this.ischeck=!0,this.id=t.id},close:function(){this.rolename="",this.$refs.tree&&this.$refs.tree.$refs.tree.setCheckedKeys([]),this.menus=[]},shouquan:function(){this.innerVisible=!0,this.$refs.tree&&this.$refs.tree.$refs.tree.setCheckedKeys(this.menus)}},mounted:function(){this.getrolelist()}},n={render:function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"role"},[i("el-row",[i("el-col",{staticStyle:{"padding-top":"15px","padding-bottom":"15px",background:"#E4E7ED"}},[i("div",{staticStyle:{"margin-left":"10px"}},[i("el-button",{attrs:{type:"primary",size:"small"},on:{click:e.addrole}},[e._v(e._s(e.$t("message.role-0")))])],1)])],1),e._v(" "),i("el-row",[i("el-col",[i("div",{staticStyle:{"margin-left":"10px","margin-top":"10px"}},[i("el-table",{staticStyle:{width:"100%"},attrs:{data:e.tableData,border:"",stripe:"",fit:""}},[i("el-table-column",{attrs:{prop:"name",label:e.$t("message.user-6")}}),e._v(" "),i("el-table-column",{attrs:{label:e.$t("message.device-20")},scopedSlots:e._u([{key:"default",fn:function(t){return[i("el-button",{attrs:{size:"mini",type:"danger"},on:{click:function(i){e.btndetele(t.$index,t.row,e.tableData)}}},[e._v(e._s(e.$t("message.devicetype-3"))+"\n                            ")]),e._v(" "),i("el-button",{attrs:{size:"mini",type:"primary"},on:{click:function(i){e.btndcheck(t.$index,t.row)}}},[e._v(e._s(e.$t("message.role-4"))+"\n                            ")])]}}])})],1),e._v(" "),i("div",{staticStyle:{"text-align":"right","margin-right":"20px","margin-top":"20px"}},[i("el-pagination",{attrs:{layout:"prev, pager, next","page-count":e.total,"pager-count":11,"current-page":e.currentPage},on:{"current-change":e.handleCurrentChange}})],1)],1)])],1),e._v(" "),i("el-dialog",{attrs:{title:e.$t("message.role-1"),visible:e.centerDialogVisible,width:"30%"},on:{"update:visible":function(t){e.centerDialogVisible=t},close:e.close}},[i("el-dialog",{attrs:{width:"30%",title:e.$t("message.role-3"),visible:e.innerVisible,"append-to-body":""},on:{"update:visible":function(t){e.innerVisible=t}}},[i("tree",{ref:"tree",attrs:{information:e.information,menus:e.menus},on:{dataRecieve:e.dataRecieve}}),e._v(" "),i("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[i("el-button",{attrs:{type:"primary",plain:""},on:{click:function(t){e.innerVisible=!1}}},[e._v(e._s(e.$t("message.devicetype-4")))]),e._v(" "),i("el-button",{attrs:{type:"success",plain:""},on:{click:e.btnconfirmin}},[e._v(e._s(e.$t("message.devicetype-8")))])],1)],1),e._v(" "),i("div",{staticClass:"input-demo-suffix"},[i("p",{staticStyle:{display:"inline-block",width:"80px","text-align-last":"justify"}},[e._v(e._s(e.$t("message.role-2"))+":")]),e._v(" "),i("el-input",{staticClass:"elinput",attrs:{placeholder:e.$t("message.device-11")},model:{value:e.rolename,callback:function(t){e.rolename=t},expression:"rolename"}})],1),e._v(" "),i("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[i("el-button",{attrs:{type:"success",plain:""},on:{click:e.shouquan}},[e._v(e._s(e.$t("message.role-3")))]),e._v(" "),i("el-button",{on:{click:function(t){e.centerDialogVisible=!1}}},[e._v(e._s(e.$t("message.devicetype-4")))]),e._v(" "),i("el-button",{attrs:{type:"primary"},on:{click:e.btnconfirm}},[e._v(e._s(e.$t("message.devicetype-8")))])],1)],1)],1)},staticRenderFns:[]};var a=i("VU/8")(s,n,!1,function(e){i("HUGw")},"data-v-73ea2418",null);t.default=a.exports},HUGw:function(e,t){},"SYG/":function(e,t){},pl2G:function(e,t,i){"use strict";var s=i("BO1k"),n=i.n(s);function a(e,t){for(var i={},s=0;s<e.length;s++){var a=e[s].parentId;i[a]?i[a].push(e[s]):(i[a]=[],i[a].push(e[s]))}return function e(t,i){var s=[];if(!t[i])return s;var a=!0;var r=!1;var o=void 0;try{for(var l,c=n()(t[i]);!(a=(l=c.next()).done);a=!0){var d=l.value;d.children=e(t,d.id),s.push(d)}}catch(e){r=!0,o=e}finally{try{!a&&c.return&&c.return()}finally{if(r)throw o}}return s}(i,t)}var r={data:function(){return{props:{label:"name",children:"children"},data:[]}},methods:{check:function(){var e=this.$refs.tree.getCheckedNodes(),t=this.$refs.tree.getHalfCheckedNodes(),i=e.concat(t);this.$emit("dataRecieve",i)},getlist:function(){var e=this;e.ajax(e.HOST+"/v1/sys/menu/findAll",{userId:$.cookie("userId")},function(t){if(0==t.data.errCode){var i=a(t.data.data,"#");e.data=i}},function(e){})}},props:{menus:{type:Array}},mounted:function(){this.getlist()}},o={render:function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticStyle:{border:"1px solid #d1dbe5"}},[t("el-tree",{ref:"tree",attrs:{props:this.props,data:this.data,"show-checkbox":"","node-key":"id","default-expand-all":"","default-checked-keys":this.menus},on:{check:this.check}})],1)},staticRenderFns:[]};var l=i("VU/8")(r,o,!1,function(e){i("SYG/")},null,null);t.a=l.exports}});